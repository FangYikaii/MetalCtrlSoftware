<UserControl x:Class="MetalizationSystem.Views.OrderEditing"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:MetalizationSystem.Views"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes" 
             xmlns:locals="clr-namespace:MetalizationSystem" xmlns:pages="clr-namespace:MetalizationSystem.ViewModels" 
             d:DataContext="{d:DesignInstance Type=pages:OrderEditingViewModel}"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <materialDesign:Card>
        <TabControl  >
            <TabItem Header="当前订单" Height="30">
                <StackPanel>
                    <DataGrid  ItemsSource="{Binding CurOrderList}" SelectedIndex="{Binding SelectRowCur}" Style="{StaticResource  MaterialDesignDataGrid}" ColumnHeaderStyle="{StaticResource  MaterialDesignDataGridColumnHeader }" CellStyle="{StaticResource MaterialDesignDataGridCell}" AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.ContextMenu>
                            <ContextMenu>
                                <MenuItem Name="Delete" Header="删除" Command="{Binding Delete_CurTaskCommand}"/>
                                <Separator/>
                                <MenuItem  Header="清空任务" Command="{Binding Clear_CurTaskCommand}"/>
                                <Separator/>
                                <MenuItem  Header="上移" Command="{Binding MoveUp_CurTaskCommand}"/>
                                <Separator/>
                                <MenuItem  Header="下移" Command="{Binding MoveDown_CurTaskCommand}"/>
                            </ContextMenu>
                        </DataGrid.ContextMenu>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="SN" Binding="{ Binding Path = SN}"/>
                            <DataGridTextColumn Header="完成状态" Binding="{ Binding Path = IsFinish}"/>
                            <DataGridTextColumn Header="工作中" Binding="{ Binding Path = IsBusy}"/>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.Solvent[1].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.Solvent[1].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
                       RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.Solvent[2].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.Solvent[2].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
    RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.Solvent[3].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.Solvent[3].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.Solvent[4].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.Solvent[4].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.TransitionFluid[1].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding  DataContext.MOrderInfo.LiquidDispensing.TransitionFluid[1].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
     RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.TransitionFluid[2].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.TransitionFluid[2].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.TransitionFluid[3].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.TransitionFluid[3].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.TransitionFluid[4].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.TransitionFluid[4].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.TransitionFluid[5].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.TransitionFluid[5].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>             
                            <DataGridTextColumn Header="Count"  Binding="{ Binding Path = Count}" />
                        </DataGrid.Columns>
                    </DataGrid>

                    <locals:ButtonEx Margin="5"  Command="{Binding CurTaskSaveCommand}"   Grid.Column="2" Content="更新" FontFamily="kaiti" FontSize="10" Foreground="#4834d4" OnMouseOverForegroundColor="#4834d4" ImageSize="40"
PathData="M725.333333 0c70.656 0 298.666667 228.096 298.666667 298.666667v597.333333a128 128 0 0 1-128 128H128a128 128 0 0 1-128-128V128a128 128 0 0 1 128-128zM170.666667 85.333333H128a42.666667 42.666667 0 0 0-42.666667 42.666667v768a42.666667 42.666667 0 0 0 42.666667 42.666667h768a42.666667 42.666667 0 0 0 42.666667-42.666667V298.666667c0-10.752-39.850667-56.448-85.333334-102.826667V341.333333a128 128 0 0 1-120.490666 127.786667L725.333333 469.333333H298.666667a128 128 0 0 1-127.786667-120.490666L170.666667 341.333333V85.333333z m554.666666 682.666667a42.666667 42.666667 0 0 1 0 85.333333H298.666667a42.666667 42.666667 0 0 1 0-85.333333h426.666666z m-128-170.666667a42.666667 42.666667 0 0 1 0 85.333334H298.666667a42.666667 42.666667 0 0 1 0-85.333334h298.666666z m128-512H256v256a42.666667 42.666667 0 0 0 37.674667 42.368L298.666667 384h426.666666a42.666667 42.666667 0 0 0 42.368-37.674667L768 341.333333V114.858667c-20.821333-17.92-36.821333-29.525333-42.666667-29.525334z">
                    </locals:ButtonEx>

                </StackPanel>              
            </TabItem>
            <TabItem Header="新增订单">
                <StackPanel>
                        <DataGrid   ItemsSource="{Binding OrderList}" SelectedIndex="{Binding SelectRow}" Style="{StaticResource  MaterialDesignDataGrid}" ColumnHeaderStyle="{StaticResource  MaterialDesignDataGridColumnHeader}" CellStyle="{StaticResource  MaterialDesignDataGridCell}" AutoGenerateColumns="False" >
                            <DataGrid.ContextMenu>
                                <ContextMenu>
                                    <MenuItem  Header="创建新任务" Command="{Binding Creat_TaskCommand}"/>
                                    <Separator/>
                                    <MenuItem Header="删除" Command="{Binding Delete_TaskCommand}"/>
                                    <Separator/>
                                    <MenuItem  Header="清空任务" Command="{Binding Clear_TaskCommand}"/>
                                    <Separator/>
                                    <MenuItem  Header="上移" Command="{Binding MoveUp_TaskCommand}"/>
                                    <Separator/>
                                    <MenuItem  Header="下移" Command="{Binding MoveDown_TaskCommand}"/>
                                    <Separator/>
                                    <MenuItem  Header="复制" Command="{Binding Copy_TaskCommand}"/>
                                    <Separator/>
                                    <MenuItem  Header="粘贴" Command="{Binding Paste_TaskCommand}"/>
                                </ContextMenu>
                            </DataGrid.ContextMenu>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="SN" Binding="{ Binding Path = SN}"/>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.Solvent[1].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.Solvent[1].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
                       RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.Solvent[2].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.Solvent[2].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
    RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.Solvent[3].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.Solvent[3].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.Solvent[4].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.Solvent[4].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.TransitionFluid[1].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding  DataContext.MOrderInfo.LiquidDispensing.TransitionFluid[1].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
     RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.TransitionFluid[2].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.TransitionFluid[2].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.TransitionFluid[3].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.TransitionFluid[3].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.TransitionFluid[4].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.TransitionFluid[4].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn  Binding="{ Binding Path = LiquidDispensing.TransitionFluid[5].Use}">
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.MOrderInfo.LiquidDispensing.TransitionFluid[5].Name,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,
RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Count"  Binding="{ Binding Path = Count}" />
                            </DataGrid.Columns>
                        </DataGrid>                       
          
                    <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                        <locals:ButtonEx Margin="5"  Command="{Binding ImportExcelCommand}"  Content="导入" FontFamily="kaiti" FontSize="10" Foreground="#8CBA5F" OnMouseOverForegroundColor="#8CBA5F" ImageSize="40"
PathData="M319.9 472.2l-51.2-63h-64l83.2 102.4L204.8 614h64l51.2-63 51.2 63h64L352 511.6l83.2-102.4h-64l-51.3 63zM204.8 716.4h-51.2c-14.1 0-25.6-11.5-25.6-25.6V332.4c0-14.1 11.5-25.6 25.6-25.6h51.2V153.2c0-28.3 22.9-51.2 51.2-51.2h588.8c28.3 0 51.2 22.9 51.2 51.2V870c0 28.3-22.9 51.2-51.2 51.2H255.9c-28.3 0-51.2-22.9-51.2-51.2V716.4z m25.5 0V870c0 14.1 11.5 25.6 25.6 25.6h588.8c14.1 0 25.6-11.5 25.6-25.6V153.2c0-14.1-11.5-25.6-25.6-25.6H255.9c-14.1 0-25.6 11.5-25.6 25.6v153.6h256c14.1 0 25.6 11.5 25.6 25.6v358.4c0 14.1-11.5 25.6-25.6 25.6h-256z m358.5-320h204.8c7.1 0 12.8 5.7 12.8 12.8 0 7.1-5.7 12.8-12.8 12.8H588.8c-7.1 0-12.8-5.7-12.8-12.8-0.1-7.1 5.7-12.8 12.8-12.8z m0 102.4h204.8c7.1 0 12.8 5.7 12.8 12.8 0 7.1-5.7 12.8-12.8 12.8H588.8c-7.1 0-12.8-5.7-12.8-12.8-0.1-7.1 5.7-12.8 12.8-12.8z m0 102.4h204.8c7.1 0 12.8 5.7 12.8 12.8 0 7.1-5.7 12.8-12.8 12.8H588.8c-7.1 0-12.8-5.7-12.8-12.8-0.1-7.1 5.7-12.8 12.8-12.8z m0 0">
                        </locals:ButtonEx>
                        <locals:ButtonEx Margin="5"  Command="{Binding ExportExcelCommand}"  Content="导出" FontFamily="kaiti" FontSize="10" Foreground="#8CBA5F" OnMouseOverForegroundColor="#8CBA5F" ImageSize="40"
PathData="M319.9 472.2l-51.2-63h-64l83.2 102.4L204.8 614h64l51.2-63 51.2 63h64L352 511.6l83.2-102.4h-64l-51.3 63zM204.8 716.4h-51.2c-14.1 0-25.6-11.5-25.6-25.6V332.4c0-14.1 11.5-25.6 25.6-25.6h51.2V153.2c0-28.3 22.9-51.2 51.2-51.2h588.8c28.3 0 51.2 22.9 51.2 51.2V870c0 28.3-22.9 51.2-51.2 51.2H255.9c-28.3 0-51.2-22.9-51.2-51.2V716.4z m25.5 0V870c0 14.1 11.5 25.6 25.6 25.6h588.8c14.1 0 25.6-11.5 25.6-25.6V153.2c0-14.1-11.5-25.6-25.6-25.6H255.9c-14.1 0-25.6 11.5-25.6 25.6v153.6h256c14.1 0 25.6 11.5 25.6 25.6v358.4c0 14.1-11.5 25.6-25.6 25.6h-256z m358.5-320h204.8c7.1 0 12.8 5.7 12.8 12.8 0 7.1-5.7 12.8-12.8 12.8H588.8c-7.1 0-12.8-5.7-12.8-12.8-0.1-7.1 5.7-12.8 12.8-12.8z m0 102.4h204.8c7.1 0 12.8 5.7 12.8 12.8 0 7.1-5.7 12.8-12.8 12.8H588.8c-7.1 0-12.8-5.7-12.8-12.8-0.1-7.1 5.7-12.8 12.8-12.8z m0 102.4h204.8c7.1 0 12.8 5.7 12.8 12.8 0 7.1-5.7 12.8-12.8 12.8H588.8c-7.1 0-12.8-5.7-12.8-12.8-0.1-7.1 5.7-12.8 12.8-12.8z m0 0">
                        </locals:ButtonEx>
                        <locals:ButtonEx Margin="5"  Command="{Binding SaveCommand}"   Grid.Column="2" Content="增加" FontFamily="kaiti" FontSize="10" Foreground="#4834d4" OnMouseOverForegroundColor="#4834d4" ImageSize="40"
PathData="M725.333333 0c70.656 0 298.666667 228.096 298.666667 298.666667v597.333333a128 128 0 0 1-128 128H128a128 128 0 0 1-128-128V128a128 128 0 0 1 128-128zM170.666667 85.333333H128a42.666667 42.666667 0 0 0-42.666667 42.666667v768a42.666667 42.666667 0 0 0 42.666667 42.666667h768a42.666667 42.666667 0 0 0 42.666667-42.666667V298.666667c0-10.752-39.850667-56.448-85.333334-102.826667V341.333333a128 128 0 0 1-120.490666 127.786667L725.333333 469.333333H298.666667a128 128 0 0 1-127.786667-120.490666L170.666667 341.333333V85.333333z m554.666666 682.666667a42.666667 42.666667 0 0 1 0 85.333333H298.666667a42.666667 42.666667 0 0 1 0-85.333333h426.666666z m-128-170.666667a42.666667 42.666667 0 0 1 0 85.333334H298.666667a42.666667 42.666667 0 0 1 0-85.333334h298.666666z m128-512H256v256a42.666667 42.666667 0 0 0 37.674667 42.368L298.666667 384h426.666666a42.666667 42.666667 0 0 0 42.368-37.674667L768 341.333333V114.858667c-20.821333-17.92-36.821333-29.525333-42.666667-29.525334z">
                        </locals:ButtonEx>
                    </StackPanel>
                   
                </StackPanel>
        
            </TabItem>
        </TabControl>
    </materialDesign:Card>
</UserControl>
